/**
 * IO - Modern lightweight DOM utility library
 * Version: 1.0.5
 * Author: Gigoland.com
 * License: MIT License
 * Repository: https://github.com/Gigoland/IO
 * Description: Lightweight utility for DOM manipulation, events, attributes, CSS, and HTML handling. Users are responsible for sanitizing HTML input using sanitizeXSS manually.
 */
class IO{constructor(e,t=document){if("string"==typeof e){if((e=e.trim()).startsWith("<")&&e.endsWith(">")){const t=document.createElement("template");return t.innerHTML=e,void(this.elements=Array.from(t.content.children))}if("body"===e)t instanceof Document&&t.body?this.elements=[t.body]:this.elements=[];else if(/^#[^\s][\S]*$/.test(e)){const n=e.slice(1),s=!t.getElementById||t instanceof DocumentFragment?t.querySelector(`#${CSS.escape(n)}`):t.getElementById(n);this.elements=s?[s]:[]}else this.elements=Array.from(t.querySelectorAll(e)),this.elements.length}else e instanceof Element?this.elements=[e]:e instanceof Document?e.body?this.elements=[e.body]:this.elements=[]:e instanceof NodeList||Array.isArray(e)?this.elements=Array.from(e).filter((e=>e instanceof Element)):this.elements=[];this.elements??=[]}forEach(e,t=!0){return this.elements.forEach(((n,s)=>e.call(n,t?n:new IO(n),s))),this}each(e){return this.forEach(e,!1)}native(e=0){return Number.isInteger(e)?this.elements[e]??null:null}allNative(){return this.elements??[]}show(e=!1){return this.forEach((t=>{if("string"==typeof e)return void(t.style.display=e);const n=t.dataset.ioDisplay;t.style.display=!0===e?"":n&&"none"!==n?n:"block"}))}hide(){return this.forEach((e=>{e.dataset.ioDisplay=getComputedStyle(e).display,e.style.display="none"}))}toggleVisibility(){return this.forEach((e=>{const t=getComputedStyle(e).display;if("none"===t){const t=e.dataset.ioDisplay||"block";e.style.display=t}else e.dataset.ioDisplay=t,e.style.display="none"}))}fadeIn(e=400,t=null){return this.forEach((n=>{n._ioFadeHandler&&n.removeEventListener("transitionend",n._ioFadeHandler),n.style.opacity="0",n.style.display=n.dataset.ioDisplay||"block",n.offsetHeight,n.style.transition=`opacity ${e}ms ease-in-out`,n.style.opacity="1";const s=()=>{n.style.transition="",n.removeEventListener("transitionend",s),delete n._ioFadeHandler,t&&"function"==typeof t&&t.call(n,n)};n._ioFadeHandler=s,n.addEventListener("transitionend",s)}))}fadeOut(e=400,t=null){return this.forEach((n=>{n._ioFadeHandler&&n.removeEventListener("transitionend",n._ioFadeHandler),n.style.transition=`opacity ${e}ms ease-in-out`,n.style.opacity="0";const s=()=>{n.style.display="none",n.style.transition="",n.removeEventListener("transitionend",s),delete n._ioFadeHandler,t&&"function"==typeof t&&t.call(n,n)};n._ioFadeHandler=s,n.addEventListener("transitionend",s)}))}fadeToggle(e=400,t=null){return this.elements.forEach((n=>{const s="none"!==getComputedStyle(n).display,r=new IO(n);s?r.fadeOut(e,t):r.fadeIn(e,t)})),this}enable(){return this.forEach((e=>{"disabled"in e&&(e.disabled=!1),e.style.pointerEvents="auto",e.classList.remove("disabled","opacity-25")}))}disable(){return this.forEach((e=>{"disabled"in e&&(e.disabled=!0),e.style.pointerEvents="none",e.classList.add("disabled","opacity-25")}))}addClass(...e){if(!e.length||e.some((e=>!e||"string"!=typeof e||!e.trim())))return this;const t=e.flatMap((e=>e.trim().split(/\s+/)));return this.elements.forEach((e=>e.classList.add(...t))),this}removeClass(...e){if(!e.length||e.some((e=>!e||"string"!=typeof e||!e.trim())))return this;const t=e.flatMap((e=>e.trim().split(/\s+/)));return this.elements.forEach((e=>e.classList.remove(...t))),this}toggleClass(...e){if(!e.length||e.some((e=>!e||"string"!=typeof e||!e.trim())))return this;const t=e.flatMap((e=>e.trim().split(/\s+/)));return this.elements.forEach((e=>{t.forEach((t=>e.classList.toggle(t)))})),this}hasClass(...e){return!(!e.length||e.some((e=>!e||"string"!=typeof e||!e.trim())))&&(!!this.elements[0]&&e.every((e=>this.elements[0].classList.contains(e.trim()))))}text(e){return void 0===e?this.elements[0]?this.elements[0].textContent:null:"string"!=typeof e&&"number"!=typeof e?this:this.forEach((t=>t.textContent=e))}html(e){return void 0===e?this.elements[0]?this.elements[0].innerHTML:null:"string"!=typeof e&&"number"!=typeof e?this:this.forEach((t=>t.innerHTML=String(e)))}htmlAdd(e){return"string"!=typeof e&&"number"!=typeof e?this:this.forEach((t=>{const n=t.textContent.trim();"number"==typeof e&&!isNaN(parseFloat(n))&&Number.isFinite(parseFloat(n))?t.innerHTML=(parseFloat(n)+e).toString():t.innerHTML+=String(e)}))}htmlSub(e){return"string"!=typeof e&&"number"!=typeof e?this:this.forEach((t=>{const n=t.textContent.trim();"number"==typeof e&&!isNaN(parseFloat(n))&&Number.isFinite(parseFloat(n))?t.innerHTML=(parseFloat(n)-e).toString():t.innerHTML=t.innerHTML.replace(new RegExp(this.escapeRegExp(String(e)),"g"),"")}))}htmlAppend(e){return e instanceof IO&&0===e.elements.length?this:this.forEach(((t,n)=>{if("string"==typeof e)t.insertAdjacentHTML("beforeend",e.trim());else if(e instanceof HTMLElement){const s=n<this.elements.length-1?e.cloneNode(!0):e;t.appendChild(s)}else e instanceof IO&&e.elements.forEach(((s,r)=>{const i=!(n===this.elements.length-1&&r===e.elements.length-1);t.appendChild(i?s.cloneNode(!0):s)}))}))}htmlPrepend(e){return e instanceof IO&&0===e.elements.length?this:this.forEach(((t,n)=>{if("string"==typeof e)t.insertAdjacentHTML("afterbegin",e.trim());else if(e instanceof HTMLElement){const s=n<this.elements.length-1?e.cloneNode(!0):e;t.insertBefore(s,t.firstChild)}else if(e instanceof IO){const s=Array.from(e.elements).reverse();s.forEach(((e,r)=>{const i=!(n===this.elements.length-1&&r===s.length-1);t.insertBefore(i?e.cloneNode(!0):e,t.firstChild)}))}}))}htmlBefore(e){return e instanceof IO&&0===e.elements.length?this:this.forEach(((t,n)=>{if("string"==typeof e)t.insertAdjacentHTML("beforebegin",e.trim());else if(e instanceof HTMLElement){const s=n<this.elements.length-1?e.cloneNode(!0):e;t.parentNode.insertBefore(s,t)}else e instanceof IO&&e.elements.forEach(((s,r)=>{const i=!(n===this.elements.length-1&&r===e.elements.length-1);t.parentNode.insertBefore(i?s.cloneNode(!0):s,t)}))}))}htmlAfter(e){return e instanceof IO&&0===e.elements.length?this:this.forEach(((t,n)=>{if("string"==typeof e)t.insertAdjacentHTML("afterend",e.trim());else if(e instanceof HTMLElement){const s=n<this.elements.length-1?e.cloneNode(!0):e;t.parentNode.insertBefore(s,t.nextSibling)}else e instanceof IO&&Array.from(e.elements).reverse().forEach(((s,r)=>{const i=!(n===this.elements.length-1&&r===e.elements.length-1);t.parentNode.insertBefore(i?s.cloneNode(!0):s,t.nextSibling)}))}))}htmlReplace(e){return e instanceof IO&&0===e.elements.length?this:this.forEach(((t,n)=>{if("string"==typeof e)t.insertAdjacentHTML("beforebegin",e.trim()),t.remove();else if(e instanceof HTMLElement){const s=n<this.elements.length-1?e.cloneNode(!0):e;t.parentNode.replaceChild(s,t)}else if(e instanceof IO){const s=t.parentNode;e.elements.forEach(((r,i)=>{const l=!(n===this.elements.length-1&&i===e.elements.length-1);s.insertBefore(l?r.cloneNode(!0):r,t)})),s.removeChild(t)}}))}remove(){return this.forEach((e=>e.remove()))}attr(e,t){return e&&"string"==typeof e?void 0===t?this.elements[0]?this.elements[0].getAttribute(e):null:this.forEach((n=>n.setAttribute(e,t))):void 0===t?null:this}removeAttr(e){return e&&"string"==typeof e?this.forEach((t=>t.removeAttribute(e))):this}aria(e,t){return e&&"string"==typeof e?void 0===t?this.elements[0]?this.elements[0].getAttribute(`aria-${e}`):null:this.forEach((n=>n.setAttribute(`aria-${e}`,t))):void 0===t?null:this}data(e,t){return e&&"string"==typeof e?void 0===t?this.elements[0]?this.elements[0].dataset[e]:null:this.forEach((n=>n.dataset[e]=t)):void 0===t?null:this}dataAdd(e,t){return e&&"string"==typeof e&&void 0!==t?this.forEach((n=>{const s=n.dataset[e]||"";"number"==typeof t&&!isNaN(parseFloat(s))&&Number.isFinite(parseFloat(s))?n.dataset[e]=(parseFloat(s)+t).toString():n.dataset[e]=s+t})):this}dataSub(e,t){return e&&"string"==typeof e&&void 0!==t?this.forEach((n=>{const s=n.dataset[e]||"";"number"==typeof t&&!isNaN(parseFloat(s))&&Number.isFinite(parseFloat(s))?n.dataset[e]=(parseFloat(s)-t).toString():n.dataset[e]=s.replace(new RegExp(this.escapeRegExp(String(t)),"g"),"")})):this}dataAll(){return this.elements[0]?Object.entries(this.elements[0].dataset):[]}val(e){return void 0===e?this.elements[0]&&(this.elements[0]instanceof HTMLInputElement||this.elements[0]instanceof HTMLSelectElement||this.elements[0]instanceof HTMLTextAreaElement)?this.elements[0].value:null:this.forEach((t=>{(t instanceof HTMLInputElement||t instanceof HTMLSelectElement||t instanceof HTMLTextAreaElement)&&(t.value=null!=e?String(e):"")}))}css(e,t,n=!1){return"string"==typeof e&&void 0===t?this.elements[0]?getComputedStyle(this.elements[0])[e]:null:"string"!=typeof e&&"object"!=typeof e?this:this.forEach((s=>{if("object"==typeof e)for(let t in e)if(t.startsWith("--"))s.style.setProperty(t,e[t],n?"important":"");else{const r=t.replace(/-([a-z])/g,((e,t)=>t.toUpperCase()));r in s.style&&(s.style[r]=e[t],n&&s.style.setProperty(t,e[t],"important"))}else if(e.startsWith("--"))s.style.setProperty(e,t,n?"important":"");else{const r=e.replace(/-([a-z])/g,((e,t)=>t.toUpperCase()));r in s.style&&(s.style[r]=t,n&&s.style.setProperty(e,t,"important"))}}))}on(e,t){return e&&t&&"string"==typeof e&&"function"==typeof t?this.forEach((n=>n.addEventListener(e,t))):this}off(e,t){return e&&t&&"string"==typeof e&&"function"==typeof t?this.forEach((n=>n.removeEventListener(e,t))):this}once(e,t){return this.forEach((n=>n.addEventListener(e,t,{once:!0})))}delegate(e,t,n){return e&&t&&n&&"string"==typeof e&&"string"==typeof t&&"function"==typeof n?this.forEach((s=>{s._ioDelegates||(s._ioDelegates=new Map);const r=e=>{const r=e.target.closest(t);r&&s.contains(r)&&n.call(r,e)},i=`${e}::${t}`;s._ioDelegates.has(i)||s._ioDelegates.set(i,new Map);const l=s._ioDelegates.get(i);l.has(n)||(l.set(n,r),s.addEventListener(e,r))})):this}undelegate(e,t,n){return e&&t&&"string"==typeof e&&"string"==typeof t?this.forEach((s=>{if(!s._ioDelegates)return;const r=`${e}::${t}`,i=s._ioDelegates.get(r);if(i){if(n&&"function"==typeof n){const t=i.get(n);t&&(s.removeEventListener(e,t),i.delete(n)),0===i.size&&s._ioDelegates.delete(r)}else{for(const t of i.values())s.removeEventListener(e,t);s._ioDelegates.delete(r)}0===s._ioDelegates.size&&delete s._ioDelegates}})):this}trigger(e,t={bubbles:!0,cancelable:!0},n=null){return e&&"string"==typeof e?this.forEach((s=>{const r=n?new CustomEvent(e,{...t,detail:n}):new Event(e,t);s.dispatchEvent(r)})):this}findBy(e){return new IO(e&&"string"==typeof e?this.elements.flatMap((t=>Array.from(t.querySelectorAll(e)))).slice(0,1):[])}findAllBy(e){if(!e||"string"!=typeof e)return new IO([]);const t=[];for(const n of this.elements){const s=n.querySelectorAll(e);for(let e=0;e<s.length;e++)t.push(s[e])}return new IO(t)}findById(e){if(!e||"string"!=typeof e)return new IO([]);const t=CSS.escape(e);return new IO(this.elements.flatMap((e=>{const n=e.querySelector(`#${t}`);return n?[n]:[]})).slice(0,1))}findByClass(e){return new IO(e&&"string"==typeof e?this.elements.flatMap((t=>Array.from(t.querySelectorAll(`.${e}`)))).slice(0,1):[])}findAllByClass(e){return new IO(e&&"string"==typeof e?this.elements.flatMap((t=>Array.from(t.querySelectorAll(`.${e}`)))):[])}findByName(e){return new IO(e&&"string"==typeof e?this.elements.flatMap((t=>Array.from(t.querySelectorAll(`[name="${e}"]`)))).slice(0,1):[])}findAllByName(e){return new IO(e&&"string"==typeof e?this.elements.flatMap((t=>Array.from(t.querySelectorAll(`[name="${e}"]`)))):[])}findByType(e){return new IO(e&&"string"==typeof e?this.elements.flatMap((t=>Array.from(t.querySelectorAll(`[type="${e}"]`)))).slice(0,1):[])}findAllByType(e){return new IO(e&&"string"==typeof e?this.elements.flatMap((t=>Array.from(t.querySelectorAll(`[type="${e}"]`)))):[])}findByAttr(e,t){if(!e||"string"!=typeof e)return new IO([]);const n=void 0!==t?`[${e}="${t}"]`:`[${e}]`;return new IO(this.elements.flatMap((e=>Array.from(e.querySelectorAll(n)))).slice(0,1))}findAllByAttr(e,t){if(!e||"string"!=typeof e)return new IO([]);const n=void 0!==t?`[${e}="${t}"]`:`[${e}]`;return new IO(this.elements.flatMap((e=>Array.from(e.querySelectorAll(n)))))}findParentById(e){if(!e||"string"!=typeof e)return new IO([]);const t=CSS.escape(e);return new IO(this.elements.map((e=>e.closest(`#${t}`))).filter(Boolean))}findParentByClass(e){return new IO(e&&"string"==typeof e?this.elements.map((t=>t.closest(`.${e}`))).filter(Boolean):[])}isEmptyValue(e=!0){const t=this.val();return void 0===t||["false","null",!1,null,""].includes(t)||e&&0===t}isEmptyData(e,t=!0){if(!e||"string"!=typeof e)return!0;const n=this.data(e);return void 0===n||["false","null",!1,null,""].includes(n)||t&&0===n}isNotEmptyValue(e=!0){return!this.isEmptyValue(e)}isNotEmptyData(e,t=!0){return!this.isEmptyData(e,t)}exists(){return this.elements.length>0}first(){return new IO(this.elements[0]??[])}last(){return new IO(this.elements[this.elements.length-1]??[])}eq(e){return new IO(this.elements[e]??[])}clone(e=!0,t=null){const n=new IO(this.elements.map((t=>t.cloneNode(e))));return t&&"function"==typeof t&&t(n),n}count(){return this.elements.length}escapeRegExp(e){return e.toString().replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}sanitizeXSS(e,t={allowedTags:["b","i","u","strong","em","p","div","span","a","br"],allowedAttributes:["src","href","class","id"]}){if("string"!=typeof e)return"";const{allowedTags:n,allowedAttributes:s}=t,r=document.createElement("div");r.innerHTML=e;const i=document.createDocumentFragment();i.append(...r.childNodes);const l=e=>{if(e.nodeType===Node.ELEMENT_NODE){const t=e.tagName.toLowerCase();n.includes(t)?(Array.from(e.attributes).forEach((t=>{const n=t.name.toLowerCase();(!s.includes(n)||"href"===n&&/^(javascript|data):/i.test(t.value)||n.startsWith("on")||"style"===n)&&e.removeAttribute(t.name)})),Array.from(e.childNodes).forEach(l)):e.replaceWith(...Array.from(e.childNodes).map(l))}else e.nodeType===Node.TEXT_NODE&&(e.textContent=e.textContent.replace(/(javascript|data):/gi,""));return e};return Array.from(i.childNodes).forEach(l),r.innerHTML}}const $io=(e,t)=>new IO(e,t);
